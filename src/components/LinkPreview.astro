---
import type { OgData } from '../utils/fetchOgData';

interface Props {
  og: OgData;
  index: number;
}

const { og, index } = Astro.props;
const delay = 0.15 + index * 0.1;
---

<a
  href={og.url}
  target="_blank"
  rel="noopener noreferrer"
  class="link-preview group block rounded-2xl overflow-hidden bg-white/50 backdrop-blur-sm border border-warm-200/60 hover:border-terracotta/30 hover:shadow-xl hover:shadow-terracotta/10 transition-all duration-500"
  style={`animation-delay: ${delay}s`}
>
  {/* OG Image */}
  {og.image ? (
    <div class="relative overflow-hidden aspect-[2/1]">
      <img
        src={og.image}
        alt={og.title}
        class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
        loading="lazy"
      />
      <div class="absolute inset-x-0 bottom-0 h-12 bg-gradient-to-t from-white/50 to-transparent"></div>
    </div>
  ) : (
    <div class="aspect-[3/1] bg-gradient-to-br from-warm-50 via-warm-100 to-warm-200/50 flex items-center justify-center">
      <div class="w-12 h-12 rounded-2xl bg-white/80 flex items-center justify-center shadow-sm">
        <img src={og.favicon} alt="" class="w-6 h-6 rounded" />
      </div>
    </div>
  )}

  {/* Content */}
  <div class="p-4">
    {/* Domain + Favicon */}
    <div class="flex items-center gap-2 mb-2.5">
      <img src={og.favicon} alt="" class="w-4 h-4 rounded" />
      <span class="text-xs text-warm-400 tracking-wide">{og.domain}</span>
    </div>

    {/* Title */}
    <h3 class="text-warm-800 font-semibold text-[0.9rem] leading-snug group-hover:text-terracotta transition-colors duration-300 line-clamp-2">
      {og.title}
    </h3>

    {/* Description */}
    {og.description && (
      <p class="mt-1.5 text-warm-400 text-xs leading-relaxed line-clamp-2">
        {og.description}
      </p>
    )}
  </div>
</a>

<style>
  .link-preview {
    opacity: 0;
    transform: translateY(24px);
    animation: link-enter 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  @keyframes link-enter {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
